(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[     27453,        605]
NotebookOptionsPosition[     25450,        568]
NotebookOutlinePosition[     25887,        585]
CellTagsIndexPosition[     25844,        582]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Setup", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", " ", "=", " ", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{"{", 
       RowBox[{"3", ",", "6"}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"poly", " ", "=", " ", 
     RowBox[{"RandomPolygon", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Convex\>\"", ",", "n"}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"boundary", " ", "=", " ", 
     RowBox[{"RegionBoundary", "[", "poly", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"sides", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Line", " ", "/@", " ", 
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", "2", ",", "1"}], "]"}]}], "&"}], " ", "@", " ", 
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", "2"}], "]"}]}], "&"}], " ", "@", " ", 
      RowBox[{"(", 
       RowBox[{"Flatten", " ", "@", " ", 
        RowBox[{"(", 
         RowBox[{"List", " ", "@@", " ", "boundary"}], ")"}]}], ")"}]}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"centroid", " ", "=", " ", 
     RowBox[{"RegionCentroid", "[", "poly", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ray", " ", "=", " ", 
     RowBox[{"HalfLine", "[", 
      RowBox[{"centroid", ",", 
       RowBox[{"5", "*", 
        RowBox[{"AngleVector", "[", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"2", "*", "Pi"}]}], "}"}], "]"}], "]"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"breakPoint", " ", "=", " ", 
     RowBox[{"RandomPoint", " ", "@", " ", "boundary"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.92926439718713*^9, 3.929264407884901*^9}, {
   3.929264913749811*^9, 3.929264928200409*^9}, 3.929270329137821*^9},
 CellLabel->
  "In[1049]:=",ExpressionUUID->"1184af9b-e8d6-b24a-b729-3bfe0922821b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sideList", "[", "poly_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Line", " ", "/@", " ", 
         RowBox[{"Partition", "[", 
          RowBox[{"#", ",", "2", ",", "1"}], "]"}]}], "&"}], " ", "@", " ", 
       RowBox[{"Partition", "[", 
        RowBox[{"#", ",", "2"}], "]"}]}], "&"}], " ", "@", " ", 
     RowBox[{"(", 
      RowBox[{"Flatten", " ", "@", " ", 
       RowBox[{"(", 
        RowBox[{"List", " ", "@@", " ", 
         RowBox[{"RegionBoundary", "[", "poly", "]"}]}], ")"}]}], ")"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.9292660415977592`*^9, 3.9292660917925396`*^9}, 
   3.929276689129238*^9},
 CellLabel->
  "In[898]:=",ExpressionUUID->"1981fdf0-a5d3-2e48-933c-02af69ab5c50"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"getCurrentSide", "[", 
     RowBox[{"poly_", ",", "point_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Extract", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "&"}], " ", "@", " ", 
     RowBox[{"First", " ", "@", " ", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"RegionDistance", "[", 
          RowBox[{"#", ",", "point"}], "]"}], "&"}], "]"}], " ", "@", " ", 
       RowBox[{"sideList", "[", "poly", "]"}]}]}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.929266014047666*^9, 3.929266021067821*^9}, {
  3.929266107417806*^9, 3.92926613447113*^9}},
 CellLabel->
  "In[605]:=",ExpressionUUID->"7fa1b044-c8f1-0644-80df-1fee06aecc7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lineToVecRep", "[", "line_", "]"}], " ", ":=", " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"line", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "-", 
     RowBox[{"line", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.929267043895872*^9, 3.9292670569065723`*^9}, 
   3.9292682901077785`*^9, {3.9292683372369976`*^9, 3.929268435469124*^9}, {
   3.929268529019785*^9, 3.92926858056279*^9}, {3.9292686132243824`*^9, 
   3.9292686156599617`*^9}},
 CellLabel->
  "In[606]:=",ExpressionUUID->"e39a69d5-16ec-cb46-8690-ee6912618d5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculates", " ", "raycast", " ", "from", " ", "an", " ", "arbitrary", 
    " ", "starting", " ", "point", " ", "and", " ", "angle", " ", "in", " ", 
    "a", " ", "polygon"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"castRayPolygon", "[", 
     RowBox[{"poly_", ",", " ", "point_", ",", "originVector_"}], "]"}], " ", 
    ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "currentSide", ",", "ray", ",", "sides", ",", "collisions", ",", 
        "pointOfCollision", ",", "oppRay", ",", "newDirection", ",", 
        "possibleCollisions"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sides", " ", "=", " ", 
        RowBox[{"sideList", "[", "poly", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"currentSide", " ", "=", " ", 
        RowBox[{"getCurrentSide", "[", 
         RowBox[{"poly", ",", "point"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newDirection", " ", "=", " ", 
        RowBox[{"calculateNewDirection", "[", 
         RowBox[{"originVector", ",", 
          RowBox[{"lineToVecRep", "[", "currentSide", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ray", " ", "=", " ", 
        RowBox[{"HalfLine", "[", 
         RowBox[{"point", ",", "newDirection"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"possibleCollisions", " ", "=", "   ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"List", " ", "@@", " ", 
           RowBox[{"RegionIntersection", "[", 
            RowBox[{"ray", ",", 
             RowBox[{"RegionBoundary", "@", " ", "poly"}]}], "]"}]}], ")"}], 
         "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pointOfCollision", " ", "=", " ", 
        RowBox[{"Last", " ", "@", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"SortBy", "[", 
            RowBox[{
             RowBox[{"EuclideanDistance", "[", 
              RowBox[{"#", ",", "point"}], "]"}], "&"}], "]"}], "[", 
           "possibleCollisions", "]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Echo", "[", "pointOfCollision", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"collisionSide", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "&"}], " ", "@", " ", 
         RowBox[{"Last", " ", "@", " ", 
          RowBox[{"SortBy", "[", 
           RowBox[{"sides", ",", " ", 
            RowBox[{
             RowBox[{"RegionDistance", "[", 
              RowBox[{"#", ",", "pointOfCollision"}], "]"}], "&"}]}], 
           "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", " ", "@", " ", 
        RowBox[{"{", 
         RowBox[{
         "pointOfCollision", ",", " ", "currentSide", ",", "point", ",", 
          "newDirection"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.9291058630352726`*^9, 3.929105863756462*^9}, {
   3.929107085744961*^9, 3.929107131894436*^9}, {3.929107167861328*^9, 
   3.9291072158011875`*^9}, {3.929107251046774*^9, 3.92910725327285*^9}, {
   3.929107286526327*^9, 3.929107319670336*^9}, {3.929107639998565*^9, 
   3.929107647218275*^9}, {3.929107746498512*^9, 3.929107763304322*^9}, {
   3.9291078097302494`*^9, 3.929107809934561*^9}, {3.929107894560507*^9, 
   3.929107895841379*^9}, {3.929107946368468*^9, 3.929107991078058*^9}, {
   3.929108021538986*^9, 3.9291080219678574`*^9}, {3.9291083977773876`*^9, 
   3.929108427375492*^9}, {3.929108670519642*^9, 3.92910869130966*^9}, {
   3.929108724514683*^9, 3.929108872626642*^9}, {3.92910890318314*^9, 
   3.9291089267029495`*^9}, {3.929109014598125*^9, 3.929109044967961*^9}, {
   3.929109114693651*^9, 3.929109116735628*^9}, {3.9291091801109943`*^9, 
   3.929109181299124*^9}, {3.9291092211551*^9, 3.9291092865530415`*^9}, {
   3.9291093410947704`*^9, 3.929109349050207*^9}, {3.929109489577902*^9, 
   3.92910949281014*^9}, {3.929109555771397*^9, 3.929109556042154*^9}, {
   3.929110548701313*^9, 3.929110580429974*^9}, {3.929110642640831*^9, 
   3.929110668347231*^9}, {3.929110715103197*^9, 3.9291107292197227`*^9}, {
   3.929110852897843*^9, 3.9291108530940666`*^9}, {3.929110905053165*^9, 
   3.92911090641944*^9}, {3.929111237902472*^9, 3.929111251735895*^9}, {
   3.929111329472231*^9, 3.929111330274031*^9}, {3.929111368119471*^9, 
   3.929111370474949*^9}, {3.9291114749422035`*^9, 3.929111477885187*^9}, {
   3.9291115105023613`*^9, 3.929111515914559*^9}, {3.929112113428083*^9, 
   3.9291121293800335`*^9}, {3.929112230620756*^9, 3.929112283667169*^9}, {
   3.929112384972607*^9, 3.929112393924732*^9}, {3.9291124341977797`*^9, 
   3.929112463514671*^9}, {3.929112501770663*^9, 3.929112633297182*^9}, {
   3.929112714177992*^9, 3.929112715409086*^9}, {3.929112807074927*^9, 
   3.929112809424656*^9}, {3.929112942786106*^9, 3.929112951607703*^9}, {
   3.929113028658645*^9, 3.929113104764082*^9}, {3.929113135473997*^9, 
   3.929113139727398*^9}, {3.929113191024065*^9, 3.929113192188101*^9}, {
   3.929113311548044*^9, 3.929113323808208*^9}, {3.929113776832468*^9, 
   3.9291138982162*^9}, {3.929113938807232*^9, 3.9291139404831448`*^9}, {
   3.9291139878382874`*^9, 3.929113988055033*^9}, {3.92911478568063*^9, 
   3.929114823885561*^9}, {3.9291148731420956`*^9, 3.929114878311928*^9}, {
   3.9291278228318615`*^9, 3.929127824819588*^9}, {3.929127878976364*^9, 
   3.929127947330154*^9}, {3.929128062100231*^9, 3.929128089988323*^9}, {
   3.929128277141428*^9, 3.92912828116103*^9}, {3.929128424235643*^9, 
   3.9291284347374783`*^9}, {3.9291284669552536`*^9, 3.929128483004957*^9}, {
   3.929128647351647*^9, 3.929128663632475*^9}, {3.92912884824091*^9, 
   3.929128890964033*^9}, {3.929129282199913*^9, 3.929129294544964*^9}, {
   3.929129330579735*^9, 3.9291293342705517`*^9}, {3.9291293694341354`*^9, 
   3.929129372374197*^9}, {3.9291300956708984`*^9, 3.929130121999451*^9}, {
   3.929130181848467*^9, 3.929130183451378*^9}, {3.929130512671669*^9, 
   3.929130531265236*^9}, {3.929130573401676*^9, 3.929130581385544*^9}, {
   3.9291328529426155`*^9, 3.929132855615484*^9}, 3.92913291161932*^9, {
   3.9292645313543224`*^9, 3.929264543714184*^9}, {3.929264855566607*^9, 
   3.929264856014004*^9}, 3.929264979991852*^9, {3.929265049964166*^9, 
   3.929265076511038*^9}, {3.929265123317295*^9, 3.929265123780916*^9}, {
   3.929265170191387*^9, 3.929265174751266*^9}, {3.929266077660906*^9, 
   3.929266144716955*^9}, {3.929266333392116*^9, 3.929266361156765*^9}, {
   3.9292664081333504`*^9, 3.9292664178978825`*^9}, {3.9292665848080206`*^9, 
   3.929266618816206*^9}, {3.929266652723961*^9, 3.9292666822762375`*^9}, {
   3.929268292520101*^9, 3.929268297685623*^9}, {3.929268422166406*^9, 
   3.929268426814995*^9}, {3.929268664175382*^9, 3.929268703110861*^9}, {
   3.929268748625782*^9, 3.929268760412821*^9}, {3.92926879755427*^9, 
   3.92926882304194*^9}, {3.929268859067503*^9, 3.929268931700296*^9}, {
   3.929269168212433*^9, 3.929269173696539*^9}, {3.929269525828361*^9, 
   3.9292695260119095`*^9}, {3.929270191371055*^9, 3.9292702157800903`*^9}, {
   3.929270256727743*^9, 3.929270278508768*^9}, {3.929270399926754*^9, 
   3.929270406455726*^9}, 3.929270491139187*^9, {3.929270796316683*^9, 
   3.929270801740816*^9}, {3.929270840285723*^9, 3.9292708414167776`*^9}, {
   3.9292708962503376`*^9, 3.92927090216201*^9}, {3.929270997874037*^9, 
   3.929271002617632*^9}, {3.929271107322191*^9, 3.929271156015608*^9}, {
   3.929271241536726*^9, 3.929271241813675*^9}, {3.929274944612988*^9, 
   3.9292749463609276`*^9}, {3.9292752943658667`*^9, 
   3.9292753045488563`*^9}, {3.929275471038925*^9, 3.929275471293974*^9}, {
   3.9292765528010406`*^9, 3.929276587347536*^9}, {3.9292769004256744`*^9, 
   3.929276942578142*^9}, 3.9292771287713223`*^9, {3.9292771784135685`*^9, 
   3.9292773382141476`*^9}, {3.929277372446066*^9, 3.929277374569126*^9}, {
   3.9292774160421543`*^9, 3.9292774169369125`*^9}, {3.9292775154483757`*^9, 
   3.929277604748108*^9}, {3.929277642007559*^9, 3.9292776587810116`*^9}, {
   3.929277747731838*^9, 3.929277748440069*^9}, {3.929277836900133*^9, 
   3.9292778525189342`*^9}, 3.929277960504822*^9},
 CellLabel->
  "In[1056]:=",ExpressionUUID->"640ddbe4-cb9f-4047-9d78-78d8094573d6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9292704795856857`*^9, 
  3.9292704810960007`*^9}},ExpressionUUID->"24138bde-16eb-ed44-81c8-\
4229480f8188"],

Cell["\<\

This function calculates the new direction vector of the ball based on the \
incoming direction and the side that it hit. \
\>", "Text",
 CellChangeTimes->{{3.929264550346916*^9, 
  3.929264586340372*^9}},ExpressionUUID->"2b6a5ef7-cca4-b641-b750-\
43072ec9e88e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"calculateNewDirection", "[", 
    RowBox[{"originVector_", ",", " ", "sideVec_"}], "]"}], ":=", " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"100", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"Projection", "[", 
         RowBox[{"originVector", ",", "sideVec"}], "]"}]}], "-", 
       "originVector"}], ")"}]}], "\[IndentingNewLine]", ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.929264534614929*^9, 3.9292645459031906`*^9}, {
  3.929265659100853*^9, 3.929265664749025*^9}, {3.9292698846616993`*^9, 
  3.929269895577461*^9}, {3.929269936145357*^9, 3.9292699512294025`*^9}, {
  3.929270123281294*^9, 
  3.929270125547722*^9}},ExpressionUUID->"44db346e-1af8-2841-9bfc-\
0e9866df712e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"castInfo", " ", "=", " ", 
     RowBox[{"castRayPolygon", "[", 
      RowBox[{"poly", ",", " ", "breakPoint", ",", " ", 
       RowBox[{"breakPoint", "-", "centroid"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newRay", " ", "=", " ", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"castInfo", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"castInfo", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newCast", " ", "=", " ", 
     RowBox[{"castRayPolygon", "[", 
      RowBox[{"poly", ",", " ", 
       RowBox[{"castInfo", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"castInfo", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Echo", " ", "@", " ", "newCast"}]}]}]], "Input",
 CellChangeTimes->{{3.929105875983856*^9, 3.9291058873708115`*^9}, {
   3.929106333964365*^9, 3.929106417713798*^9}, {3.929106452526177*^9, 
   3.9291064587893295`*^9}, {3.9291065409135017`*^9, 3.929106601488096*^9}, {
   3.929106648307898*^9, 3.929106650408924*^9}, {3.929106700122227*^9, 
   3.92910672678133*^9}, {3.9291067852235756`*^9, 3.929107035072243*^9}, {
   3.929107226888256*^9, 3.929107235286957*^9}, {3.929107862637991*^9, 
   3.9291078630595*^9}, {3.9291079382238407`*^9, 3.9291079387594204`*^9}, {
   3.929108082875326*^9, 3.9291082215145626`*^9}, {3.929108490075575*^9, 
   3.929108572587557*^9}, {3.9291086099151344`*^9, 3.9291086122662506`*^9}, 
   3.9291090890863495`*^9, 3.9291127203290844`*^9, {3.929130220665734*^9, 
   3.929130259627544*^9}, {3.929130492803213*^9, 3.929130495316492*^9}, {
   3.929130541914896*^9, 3.929130548528614*^9}, {3.92913060245879*^9, 
   3.929130602961247*^9}, {3.929131852865305*^9, 3.929131896014464*^9}, {
   3.92913257893759*^9, 3.9291325972508755`*^9}, 3.9291327110838814`*^9, {
   3.929132777151875*^9, 3.929132780010094*^9}, {3.929132867986628*^9, 
   3.9291328945274715`*^9}, {3.9291329750211105`*^9, 3.929133052415497*^9}, {
   3.929133095504452*^9, 3.929133135577257*^9}, {3.929133186338032*^9, 
   3.929133355100504*^9}, {3.9291333977282104`*^9, 3.929133398689722*^9}, {
   3.929263960342928*^9, 3.92926404694973*^9}, {3.929264083807789*^9, 
   3.9292641242117863`*^9}, {3.9292641637869015`*^9, 3.929264178003799*^9}, {
   3.929264209633997*^9, 3.929264220628107*^9}, 3.9292642730664425`*^9, 
   3.929264393188276*^9, 3.9292644725310745`*^9, {3.929264613076582*^9, 
   3.929264643624239*^9}, {3.929264772491625*^9, 3.929264780656513*^9}, {
   3.92926488971986*^9, 3.929264895178129*^9}, {3.929265279821903*^9, 
   3.929265302089605*^9}, {3.929265356213114*^9, 3.929265356431724*^9}, {
   3.9292663282615204`*^9, 3.929266329972294*^9}, {3.9292667261865673`*^9, 
   3.929266728765423*^9}, {3.929269143822592*^9, 3.929269162333507*^9}, {
   3.929269199797703*^9, 3.929269251157908*^9}, {3.929269360315876*^9, 
   3.929269364078026*^9}, {3.9292694012597647`*^9, 3.929269402918949*^9}, {
   3.9292694563404827`*^9, 3.929269459734253*^9}, {3.929269533909811*^9, 
   3.929269534135183*^9}, {3.929269625632089*^9, 3.929269647954973*^9}, {
   3.929269708686486*^9, 3.9292697127832623`*^9}, {3.929269751293997*^9, 
   3.9292697826567116`*^9}, {3.9292701443489437`*^9, 
   3.9292701447300777`*^9}, {3.9292755100384007`*^9, 3.929275512580118*^9}, {
   3.9292764333614616`*^9, 3.9292764340383415`*^9}, {3.9292767886069527`*^9, 
   3.9292768070373936`*^9}, {3.929276858730669*^9, 3.9292768642910233`*^9}, {
   3.929277042908184*^9, 3.929277109582201*^9}, {3.929277402646555*^9, 
   3.9292774028413467`*^9}, 3.9292775865033817`*^9, {3.9292778878087177`*^9, 
   3.9292779477519035`*^9}, {3.929277986876116*^9, 3.9292779879341335`*^9}},
 CellLabel->
  "In[1061]:=",ExpressionUUID->"0ce454a8-0b94-e246-9ecb-e37d80c8e134"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.04877671488212186`"}], ",", 
   RowBox[{"-", "0.06072067355821774`"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.92927740345722*^9, 3.929277433903408*^9}, {
   3.929277522551388*^9, 3.92927760796311*^9}, 3.929277661328457*^9, {
   3.929277733903076*^9, 3.929277758738085*^9}, 3.9292778245556774`*^9, 
   3.9292778563437405`*^9, {3.9292779179617558`*^9, 3.9292779882522697`*^9}},
 CellLabel->
  "During evaluation of \
In[1061]:=",ExpressionUUID->"d3e502bc-075e-a148-9517-6b9dfcd7a296"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.04463170583672522`", ",", "0.01960677074587368`"}], 
  "}"}]], "Echo",
 CellChangeTimes->{
  3.9292779884356155`*^9},ExpressionUUID->"68a3181c-9af4-2c48-863b-\
9edc46fa0ba8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.178490319354905`", ",", 
   RowBox[{"-", "7.47769089017669`"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.92927740345722*^9, 3.929277433903408*^9}, {
   3.929277522551388*^9, 3.92927760796311*^9}, 3.929277661328457*^9, {
   3.929277733903076*^9, 3.929277758738085*^9}, 3.9292778245556774`*^9, 
   3.9292778563437405`*^9, {3.9292779179617558`*^9, 3.929277988516655*^9}},
 CellLabel->
  "During evaluation of \
In[1061]:=",ExpressionUUID->"1390be0c-6486-c347-9f1e-51e3ea126fd9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.013989146492645927`", ",", "0.07022483530568527`"}], 
  "}"}]], "Echo",
 CellChangeTimes->{
  3.9292779886743603`*^9},ExpressionUUID->"787cc6ad-87b1-404f-a4ea-\
0feddd7dff7f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.013989146492645927`", ",", "0.07022483530568527`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.1205960274427369`", ",", "0.052978003385817374`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.04463170583672522`", ",", "0.01960677074587368`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "403.34492213281186`"}], ",", "666.2804852276711`"}], 
    "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.929277988724312*^9},ExpressionUUID->"c1ec5d58-4039-234c-9646-\
b6ad1309b570"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.013989146492645927`", ",", "0.07022483530568527`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.1205960274427369`", ",", "0.052978003385817374`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.04463170583672522`", ",", "0.01960677074587368`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "403.34492213281186`"}], ",", "666.2804852276711`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.929277949184595*^9, 3.929277988773554*^9}},
 CellLabel->
  "Out[1064]=",ExpressionUUID->"87fbf901-2129-5a49-ba3c-84e4d3fca691"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Graphics", "[", 
   RowBox[{"{", 
    RowBox[{"boundary", ",", " ", "Red", ",", " ", 
     RowBox[{"Point", "[", "centroid", "]"}], ",", "Blue", ",", 
     RowBox[{"Point", "[", 
      RowBox[{"castInfo", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "LightRed", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"breakPoint", ",", "centroid"}], "}"}], "]"}], ",", "Blue", 
     ",", "LightRed", ",", "newRay", ",", "Blue", ",", 
     RowBox[{"Point", "[", 
      RowBox[{"castInfo", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
     RowBox[{"Point", "[", 
      RowBox[{"newCast", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "LightRed", ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"newCast", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"newCast", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.929269767075117*^9, 3.929269767988199*^9}, {
   3.9292698690794983`*^9, 3.929269869455286*^9}, {3.9292699789910336`*^9, 
   3.929269984269375*^9}, {3.929270136690504*^9, 3.929270158589426*^9}, {
   3.929270915821888*^9, 3.929270924016094*^9}, {3.929274739574871*^9, 
   3.929274739826193*^9}, {3.9292748953105145`*^9, 3.929274928100605*^9}, {
   3.9292752850034924`*^9, 3.929275286706028*^9}, {3.929275324137348*^9, 
   3.929275325001665*^9}, {3.92927551734754*^9, 3.929275519589275*^9}, {
   3.929275702151699*^9, 3.929275752768976*^9}, {3.929275851670311*^9, 
   3.929275891514145*^9}, {3.9292759926967983`*^9, 3.9292759929043884`*^9}, {
   3.929276144520937*^9, 3.929276165332678*^9}, 3.9292763775396976`*^9, {
   3.9292766727406597`*^9, 3.929276674659012*^9}, {3.9292771360862274`*^9, 
   3.9292771545444984`*^9}, {3.9292774308328495`*^9, 3.929277449407404*^9}, {
   3.9292779223240776`*^9, 3.9292779292582264`*^9}, {3.929278006645006*^9, 
   3.9292780416623955`*^9}},
 CellLabel->
  "In[1067]:=",ExpressionUUID->"865ec1b7-a724-f242-8885-3a9c334f9ebd"],

Cell[BoxData[
 GraphicsBox[{
   LineBox[{{0., 0.}, {0.1205960274427369, 0.052978003385817374`}, {
    0.08706733773673125, 0.4370738026283949}, {0., 0.}}], 
   {RGBColor[1, 0, 0], PointBox[{0.06922112172648938, 0.16335060200473744`}]}, 
   {RGBColor[0, 0, 1], PointBox[{0.020444406844367515`, 0.1026299284465197}]}, 
   {RGBColor[1, 0.85, 0.85], 
    LineBox[{{0.020444406844367515`, 0.1026299284465197}, {
     0.06922112172648938, 0.16335060200473744`}}]}, 
   {RGBColor[1, 0.85, 0.85], 
    LineBox[{{0.020444406844367515`, 0.1026299284465197}, {
     0.04463170583672522, 0.01960677074587368}}]}, 
   {RGBColor[0, 0, 1], PointBox[{0.04463170583672522, 0.01960677074587368}], 
    PointBox[{0.013989146492645927`, 0.07022483530568527}]}, 
   {RGBColor[1, 0.85, 0.85], 
    LineBox[{{0.04463170583672522, 0.01960677074587368}, {
     0.013989146492645927`, 0.07022483530568527}}]}}]], "Output",
 CellChangeTimes->{{3.929275692674076*^9, 3.9292757601662865`*^9}, 
   3.9292757917571583`*^9, {3.9292758552287273`*^9, 3.929275892528385*^9}, 
   3.9292759937995453`*^9, {3.9292761284882565`*^9, 3.9292761563629417`*^9}, {
   3.9292763635870132`*^9, 3.92927637886849*^9}, 3.929276454093092*^9, 
   3.929276675682251*^9, {3.9292767991502495`*^9, 3.9292768104265137`*^9}, {
   3.9292769279182606`*^9, 3.9292769473560123`*^9}, 3.9292769808108616`*^9, {
   3.929277146732687*^9, 3.929277181420828*^9}, 3.9292772719719887`*^9, 
   3.9292773046505375`*^9, {3.929277399023573*^9, 3.9292774587966976`*^9}, 
   3.9292775252372837`*^9, 3.929277664209343*^9, {3.9292777363542614`*^9, 
   3.9292777605637455`*^9}, 3.9292778582367287`*^9, {3.9292779200566044`*^9, 
   3.9292779346916904`*^9}, 3.929277990315502*^9, {3.9292780269061623`*^9, 
   3.929278042076788*^9}},
 CellLabel->
  "Out[1067]=",ExpressionUUID->"29c2369a-9e98-874c-a427-07e5fa7e8389"]
}, Open  ]]
},
WindowSize->{1140, 549.6},
WindowMargins->{{0.6, Automatic}, {Automatic, 0.6}},
Magnification:>1.1 Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 16, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f4f5b2a1-c488-e845-bdfd-32a081cb1ef9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[561, 20, 2002, 54, 199, "Input",ExpressionUUID->"1184af9b-e8d6-b24a-b729-3bfe0922821b"],
Cell[2566, 76, 843, 23, 52, "Input",ExpressionUUID->"1981fdf0-a5d3-2e48-933c-02af69ab5c50"],
Cell[3412, 101, 806, 21, 52, "Input",ExpressionUUID->"7fa1b044-c8f1-0644-80df-1fee06aecc7f"],
Cell[4221, 124, 672, 16, 73, "Input",ExpressionUUID->"e39a69d5-16ec-cb46-8690-ee6912618d5b"],
Cell[4896, 142, 8398, 146, 283, "Input",ExpressionUUID->"640ddbe4-cb9f-4047-9d78-78d8094573d6"],
Cell[13297, 290, 156, 3, 31, "Input",ExpressionUUID->"24138bde-16eb-ed44-81c8-4229480f8188"],
Cell[13456, 295, 273, 7, 63, "Text",ExpressionUUID->"2b6a5ef7-cca4-b641-b750-43072ec9e88e"],
Cell[13732, 304, 786, 19, 73, "Input",ExpressionUUID->"44db346e-1af8-2841-9bfc-0e9866df712e"],
Cell[CellGroupData[{
Cell[14543, 327, 3953, 69, 136, "Input",ExpressionUUID->"0ce454a8-0b94-e246-9ecb-e37d80c8e134"],
Cell[CellGroupData[{
Cell[18521, 400, 543, 11, 24, "Print",ExpressionUUID->"d3e502bc-075e-a148-9517-6b9dfcd7a296"],
Cell[19067, 413, 216, 6, 25, "Echo",ExpressionUUID->"68a3181c-9af4-2c48-863b-9edc46fa0ba8"],
Cell[19286, 421, 517, 10, 24, "Print",ExpressionUUID->"1390be0c-6486-c347-9f1e-51e3ea126fd9"],
Cell[19806, 433, 217, 6, 25, "Echo",ExpressionUUID->"787cc6ad-87b1-404f-a4ea-0feddd7dff7f"],
Cell[20026, 441, 684, 21, 25, "Echo",ExpressionUUID->"c1ec5d58-4039-234c-9646-b6ad1309b570"]
}, Open  ]],
Cell[20725, 465, 734, 21, 50, "Output",ExpressionUUID->"87fbf901-2129-5a49-ba3c-84e4d3fca691"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21496, 491, 2100, 42, 73, "Input",ExpressionUUID->"865ec1b7-a724-f242-8885-3a9c334f9ebd"],
Cell[23599, 535, 1835, 30, 493, "Output",ExpressionUUID->"29c2369a-9e98-874c-a427-07e5fa7e8389"]
}, Open  ]]
}
]
*)

